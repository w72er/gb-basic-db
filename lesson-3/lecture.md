# DDL

Позволяет создавать элементы базы данных. Мы создадим мини
вконтакте БД.

Подходы к проектированию нормальная форма.

Материалы:
* https://dba.stackexchange.com/questions/121731/mysql-workbench-automatically-capitalized-and-reformatted-section-of-sql-script
* https://stackoverflow.com/questions/30938297/mysql-workbench-plugins-utilities-reformat-sql-query

Проектирование основывается на здравом смысле. Поэтому, если
мы проектируем бд для соц сети, с чего нам стоит начать?
users.

Идентификатор - однозначно идентифицирует запись в таблице.
Сурогатный первичный ключ получается не из данных, как снилс,
например, а создается нами для нашего удобства. И библиотеки
и фреймворки как правило по умолчанию работают с `id`.

NOT NULL - чтобы не было пустой ячейки.

Автор: `UNIQUE unique_email(email), -- уникальность для востановления пароля.`

Хранить телефон можно двумя способами:
* в числе, но мы должны быть уверены, что телефон поместится
в числе.
* В строке. Если мы уверены в формате телефона с фиксированной
шириной, то можно хранить в `CHAR(11)`
  
Пароли не храним в базе в прямом виде, поэтому хранят хэши.


При проектировании отталкиваемся от того в каком формате
храним данные, смотри пример с телефоном.

Индексы MyISAM - hash, innodb btree.

Таблица связи 1 к 1 с профилем. Делаем в учебном стиле, т.к.
в жизни практически не используется. Обычно бы профиль добавился
в таблицу `users`, но если хотим хранить таблицу в защищенном
месте, то создаем ее отдельно.

Чтобы добавить проверку, что в таблицу profiles будет
добавляться идентификатор, который есть только в `users`,
нужно сделать ссылку внешний ключ `FOREIGN KEY`.

1^17^32
1^36^37

Автор: есть какое-то условие, при котором выполняем действие,
и автор проговаривает, поскольку часто выполняем запросы по
полю, то требуется добавить по нему индекс.

## Подходы в проектировании структур данных
* Восходящий подход. Собрать всю информацию об объектах решаемой
  задачи в рамках одной таблицы и последующая декомпозиция ее на
  несколько взаимосвязанных таблиц на основе процедуры нормализации
  отношений.
* Нисходящий подход. Формулирование знаний о системе и требований к
  обработке данных, получение с помощью CASE-системы готовой
  схемы БД. В этом уроке мы использовали этот нисходящий подход.

Средства позволяют нарисовать схему в workbanch.

Избыточность

Инофрмация ханится с дублированием.

Аномалия модификации

Аномалия удаления

При увольнении сотрудника мы удаляем его запись, но при этом в строке
содержится информация о кабинете и номере телефона, но кабинет и номер
телефона остаются с нами, но запись об этом пропадает.

Аномалия Добавления
Информацию нельзя добавить сотрудника, до тех пор пока он не будет
определен.

Решение декомпозиция.

Назначение нормализации
* Исключить избыточность
* Устранить некоторые аномалии
* Разработать в проекте "качественное", интуитивно понятное и легко
  расширяемое представление реального мира;
* Упростить задание ограничений целостности. Следить чтобы в одном
  кабинете будет одни номеры телефона
  
Нормальные формы - это правила, определяют какие данные будут находится
в таблице.

Нормальная форма
* свойство отношения (таблицы), характеризующее его с точки зрения
  избыточности, потенциально прводдящей к логически ошибочным рез-там
  выборки или изменения данных
* совокупрость требований, которым должно уддовлетворять отношение.

Первая нормальная форма
1нф - поля таблицы должны содержать неделимую информацию.
* В одной ячейке хранится одно значение, нельзя написать в номере
рейса два номера, например, `242, 32`. Такую таблицу невозможно
обрабатывать.
* нет повторяющихся строк.

Вторая
* Таблица находится в 1НФ.
* любое неключевое поле однозначно идентифицируется ключевыми полями.
  Например, неключевое поле Капитан или название судна, идентифицируется
  по идентификатору судна.

Таблицу в первой нормальной форме мы можем разделить на несколько
таблиц.

Логика такая одно судно может совершать множество рейсов, и поэтому
эту связь мы устанавливаем между двумя таблицами

3НФ

3нф - все неключевые атрибуты таблицы взаимно независимы и полностью
зависят от первичного ключа.

В идеале, но не всегда.

Мы видим что поле тонаж зависит не от номера судна, а от типа судна,
поэтому нужно вынести из таблицы тоннаж.

ER-модель (модель сущность связь) (второй подход)

* Сущность
* Атрибут
* Связь

Автор: надеюсь что вы поняли, что есть нормальные формы, и за что
они отвечают.

www.sql-ex.ru - checkio
методички - выполнять упражнения